<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON File Merger</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 2em;
        }
        #drop-zone {
            border: 2px dashed #ccc;
            border-radius: 20px;
            width: 100%;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
        }
        #file-input {
            display: none;
        }
    </style>
</head>
<body>
    <h1>JSON File Merger</h1>
    <p>Select or drop your .json files below. They will be merged into a single file.</p>

    <div id="drop-zone">
        <p>Drop files here or click to select</p>
        <input type="file" id="file-input" multiple accept=".json">
    </div>

    <script>
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');

        dropZone.addEventListener('click', () => fileInput.click());

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = '#f0f0f0';
        });

        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = 'transparent';
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = 'transparent';
            const files = e.dataTransfer.files;
            handleFiles(files);
        });

        fileInput.addEventListener('change', () => {
            const files = fileInput.files;
            handleFiles(files);
        });

        function handleFiles(files) {
            let mergedData = [];
            let filesRead = 0;

            for (const file of files) {
                const reader = new FileReader();

                reader.onload = (e) => {
                    try {
                        const json = JSON.parse(e.target.result);
                        if (Array.isArray(json)) {
                            mergedData = mergedData.concat(json);
                        } else {
                            console.error(`File ${file.name} does not contain a JSON array.`);
                        }
                    } catch (error) {
                        console.error(`Error parsing JSON from ${file.name}:`, error);
                    }

                    filesRead++;
                    if (filesRead === files.length) {
                        downloadMergedJson(mergedData);
                    }
                };

                reader.readAsText(file);
            }
        }

        function downloadMergedJson(data) {
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'merged.json';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>